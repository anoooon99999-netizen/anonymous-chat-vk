<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–æ–Ω–∏–º–Ω—ã–π —á–∞—Ç | VK</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #8B5CF6; --primary-light: #A78BFA; --primary-dark: #7C3AED;
            --background: #FAF5FF; --surface: #FFFFFF; --text: #1F2937;
            --text-secondary: #6B7280; --border: #E5E7EB; --accent: #EC4899;
            --success: #10B981; --warning: #F59E0B; --error: #EF4444;
            
            /* –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ —á–∞—Ç–∞ */
            --message-bg-my: #8B5CF6;
            --message-text-my: #FFFFFF;
            --message-bg-their: #F3F4F6;
            --message-text-their: #1F2937;
            --chat-bg: #FAF5FF;
            --bubble-radius: 18px;
            --font-size: 16px;
        }

        /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
        [data-theme="dark"] {
            --primary: #A78BFA; --primary-light: #7C3AED; --primary-dark: #6D28D9;
            --background: #111827; --surface: #1F2937; --text: #F9FAFB;
            --text-secondary: #9CA3AF; --border: #374151; --accent: #EC4899;
            --success: #10B981; --warning: #F59E0B; --error: #EF4444;
            
            --message-bg-my: #7C3AED;
            --message-text-my: #FFFFFF;
            --message-bg-their: #374151;
            --message-text-their: #F9FAFB;
            --chat-bg: #111827;
        }

        /* –°–∏–Ω—è—è —Ç–µ–º–∞ */
        [data-theme="blue"] {
            --primary: #3B82F6; --primary-light: #60A5FA; --primary-dark: #2563EB;
            --background: #EFF6FF; --surface: #FFFFFF; --text: #1E3A8A;
            --text-secondary: #6B7280; --border: #BFDBFE; --accent: #EC4899;
            
            --message-bg-my: #3B82F6;
            --message-text-my: #FFFFFF;
            --message-bg-their: #E0F2FE;
            --message-text-their: #0C4A6E;
            --chat-bg: #EFF6FF;
        }

        /* –ó–µ–ª–µ–Ω–∞—è —Ç–µ–º–∞ */
        [data-theme="green"] {
            --primary: #10B981; --primary-light: #34D399; --primary-dark: #059669;
            --background: #ECFDF5; --surface: #FFFFFF; --text: #064E3B;
            --text-secondary: #6B7280; --border: #A7F3D0; --accent: #EC4899;
            
            --message-bg-my: #10B981;
            --message-text-my: #FFFFFF;
            --message-bg-their: #D1FAE5;
            --message-text-their: #065F46;
            --chat-bg: #ECFDF5;
        }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            background: var(--background); 
            color: var(--text); 
            line-height: 1.4;
            transition: all 0.3s ease;
        }
        .container { max-width: 400px; margin: 0 auto; padding: 16px; padding-bottom: 80px; background: var(--background); min-height: 100vh; }
        .header { text-align: center; margin-bottom: 24px; padding-bottom: 16px; }
        .header h1 { font-size: 34px; font-weight: 700; margin-bottom: 4px; background: linear-gradient(135deg, var(--primary), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .header p { font-size: 16px; color: var(--text-secondary); }
        
        .notification-section { background: linear-gradient(135deg, var(--primary-light), var(--accent)); color: white; padding: 20px; border-radius: 20px; margin-bottom: 24px; box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3); }
        .notification-title { font-weight: 600; margin-bottom: 8px; font-size: 17px; }
        .notification-text { font-size: 15px; color: rgba(255,255,255,0.9); margin-bottom: 16px; line-height: 1.4; }
        .notification-button { width: 100%; background: white; color: var(--primary); border: none; padding: 14px; border-radius: 14px; font-size: 17px; font-weight: 600; cursor: pointer; }
        
        /* –í–∫–ª–∞–¥–∫–∏ —á–∞—Ç–æ–≤ */
        .chat-tabs { display: flex; background: var(--surface); border-radius: 16px; padding: 4px; margin-bottom: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .chat-tab { flex: 1; text-align: center; padding: 12px; border-radius: 12px; cursor: pointer; font-weight: 500; transition: all 0.3s ease; }
        .chat-tab.active { background: var(--primary); color: white; }
        
        .user-cards { display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px; }
        .user-card { background: var(--surface); border-radius: 20px; padding: 20px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 1px solid var(--border); }
        .user-card:active { transform: scale(0.98); }
        .user-info { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 14px; }
        .info-row { display: flex; justify-content: space-between; font-size: 16px; }
        .info-label { color: var(--text-secondary); font-weight: 400; }
        .info-value { font-weight: 500; color: var(--text); }
        .theme-tag { background: linear-gradient(135deg, var(--primary), var(--accent)); color: white; padding: 6px 16px; border-radius: 20px; font-size: 14px; font-weight: 500; display: inline-block; }
        .create-chat-card { background: var(--surface); border: 2px dashed var(--primary-light); border-radius: 20px; padding: 24px; cursor: pointer; text-align: center; transition: all 0.3s ease; margin-bottom: 20px; }
        .create-chat-card:active { background: var(--primary-light); border-color: var(--primary); }
        .create-chat-icon { font-size: 32px; margin-bottom: 12px; color: var(--primary); }
        .create-chat-text { font-size: 17px; font-weight: 600; color: var(--primary); }
        
        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é */
        .bottom-menu { 
            position: fixed; 
            bottom: 0; 
            left: 50%; 
            transform: translateX(-50%); 
            background: rgba(255, 255, 255, 0.95); 
            backdrop-filter: blur(20px); 
            border-top: 1px solid var(--border); 
            display: flex; 
            padding: 12px 0; 
            z-index: 1000; 
            width: 400px; 
            max-width: 400px; 
            border-radius: 20px 20px 0 0; 
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1); 
            transition: all 0.3s ease;
        }
        
        [data-theme="dark"] .bottom-menu {
            background: rgba(31, 41, 55, 0.95);
        }
        
        /* –°–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –≤ —á–∞—Ç–µ */
        .chat-room-active .bottom-menu {
            transform: translateX(-50%) translateY(100px);
            opacity: 0;
            pointer-events: none;
        }
        
        .menu-item { flex: 1; text-align: center; padding: 8px; cursor: pointer; transition: all 0.2s ease; }
        .menu-item.active { color: var(--primary); }
        .menu-icon { font-size: 22px; margin-bottom: 4px; }
        .menu-text { font-size: 12px; font-weight: 500; }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal-overlay { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            background: rgba(0,0,0,0.4); 
            z-index: 2000; 
            align-items: center;
            justify-content: center;
        }
        .modal-content { 
            background: var(--surface); 
            border-radius: 20px; 
            padding: 24px; 
            max-height: 85vh; 
            overflow-y: auto; 
            width: calc(100% - 32px); 
            max-width: 362px;
            margin: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
        .modal-title { font-size: 22px; font-weight: 700; letter-spacing: -0.5px; color: var(--text); }
        .close-button { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--primary); padding: 8px; }
        .form-group { margin-bottom: 24px; }
        .form-label { display: block; font-weight: 600; margin-bottom: 12px; font-size: 17px; color: var(--text); }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .option-button { background: var(--background); border: 2px solid var(--border); border-radius: 14px; padding: 14px; text-align: center; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.2s ease; color: var(--text); }
        .option-button.active { background: linear-gradient(135deg, var(--primary), var(--accent)); color: white; border-color: var(--primary); }
        .age-range { display: flex; align-items: center; gap: 12px; }
        .age-input { flex: 1; padding: 14px; border: 2px solid var(--border); border-radius: 14px; font-size: 16px; text-align: center; background: var(--surface); color: var(--text); }
        .age-separator { color: var(--text-secondary); padding: 0 8px; font-weight: 500; }
        .create-button { width: 100%; background: linear-gradient(135deg, var(--primary), var(--accent)); color: white; border: none; padding: 18px; border-radius: 16px; font-size: 17px; font-weight: 600; cursor: pointer; margin-top: 8px; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4); }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        .profile-section { background: var(--surface); padding: 24px; border-radius: 20px; margin-bottom: 24px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .profile-header { text-align: center; margin-bottom: 24px; }
        .profile-avatar { width: 100px; height: 100px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center; color: white; font-size: 40px; border: 4px solid var(--surface); box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3); }
        .profile-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 24px; }
        .stat-item { text-align: center; padding: 20px; background: var(--background); border-radius: 16px; }
        .stat-value { font-size: 24px; font-weight: 700; background: linear-gradient(135deg, var(--primary), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .stat-label { font-size: 13px; color: var(--text-secondary); margin-top: 4px; font-weight: 500; }
        .settings-list { display: flex; flex-direction: column; gap: 8px; }
        .setting-item { background: var(--surface); padding: 18px; border-radius: 16px; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        .setting-item:active { background: var(--background); }
        .setting-title { font-weight: 600; margin-bottom: 4px; font-size: 17px; color: var(--text); }
        .setting-description { font-size: 15px; color: var(--text-secondary); }
        .setting-info { flex: 1; }
        .setting-arrow { color: var(--text-secondary); font-size: 18px; }
        
        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∫–∞–∫ –≤ Telegram */
        .theme-options { display: flex; flex-direction: column; gap: 12px; }
        .theme-option { display: flex; align-items: center; padding: 16px; background: var(--background); border-radius: 12px; cursor: pointer; transition: all 0.2s ease; }
        .theme-option.active { border: 2px solid var(--primary); }
        .theme-preview { width: 40px; height: 40px; border-radius: 8px; margin-right: 12px; display: flex; align-items: center; justify-content: center; }
        .theme-light { background: linear-gradient(135deg, #8B5CF6, #EC4899); }
        .theme-dark { background: linear-gradient(135deg, #1F2937, #111827); }
        .theme-blue { background: linear-gradient(135deg, #3B82F6, #60A5FA); }
        .theme-green { background: linear-gradient(135deg, #10B981, #34D399); }
        
        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞ */
        .chat-settings-options { display: flex; flex-direction: column; gap: 16px; }
        .setting-card { background: var(--surface); padding: 16px; border-radius: 12px; border: 1px solid var(--border); }
        .setting-card-title { font-weight: 600; margin-bottom: 12px; font-size: 16px; color: var(--text); }
        
        /* –ü–æ–ª–∑—É–Ω–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        .slider-group { margin-bottom: 20px; }
        .slider-label { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: 500; }
        .slider-value { color: var(--primary); font-weight: 600; }
        .slider-wrapper { position: relative; height: 20px; margin: 20px 0; }
        .slider { width: 100%; height: 6px; border-radius: 3px; background: var(--border); outline: none; -webkit-appearance: none; }
        .slider::-webkit-slider-thumb { -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%; background: var(--primary); cursor: pointer; border: 2px solid white; box-shadow: 0 2px 6px rgba(139, 92, 246, 0.4); }
        .slider::-moz-range-thumb { width: 20px; height: 20px; border-radius: 50%; background: var(--primary); cursor: pointer; border: 2px solid white; box-shadow: 0 2px 6px rgba(139, 92, 246, 0.4); }
        
        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ */
        .toggle-switch { position: relative; display: inline-block; width: 44px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--border); transition: .4s; border-radius: 24px; }
        .toggle-slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .toggle-slider { background-color: var(--primary); }
        input:checked + .toggle-slider:before { transform: translateX(20px); }
        
        /* –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏–π */
        .message-preview { display: flex; flex-direction: column; gap: 8px; padding: 16px; background: var(--chat-bg); border-radius: 12px; margin-top: 16px; }
        .preview-message { padding: 12px 16px; border-radius: var(--bubble-radius); max-width: 80%; word-wrap: break-word; font-size: var(--font-size); }
        .preview-message.my { background: var(--message-bg-my); color: var(--message-text-my); margin-left: auto; border-bottom-right-radius: 4px; }
        .preview-message.their { background: var(--message-bg-their); color: var(--message-text-their); margin-right: auto; border-bottom-left-radius: 4px; border: 1px solid var(--border); }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —á–∞—Ç–∞ */
        .screen-header { 
            display: flex; 
            align-items: center; 
            margin-bottom: 20px; 
            padding-bottom: 16px; 
            border-bottom: 1px solid var(--border);
            position: relative;
        }
        .back-button { 
            font-size: 24px; 
            background: none; 
            border: none; 
            margin-right: 12px; 
            cursor: pointer; 
            color: var(--primary);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s ease;
        }
        .back-button:hover {
            background: var(--background);
        }
        .chat-info { flex: 1; }
        .chat-title { font-weight: 600; font-size: 18px; }
        .chat-members { font-size: 14px; color: var(--text-secondary); }
        
        /* –®–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–∞—Ç–∞ */
        .chat-settings { 
            position: relative;
            margin-left: 8px;
        }
        .settings-button {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--primary);
            padding: 8px;
            border-radius: 50%;
            transition: background 0.2s ease;
        }
        .settings-button:hover {
            background: var(--background);
        }
        .settings-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 8px;
            min-width: 180px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            z-index: 1000;
        }
        .settings-dropdown.active {
            display: block;
        }
        .settings-item {
            padding: 12px;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        .settings-item:hover {
            background: var(--background);
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –≤ —á–∞—Ç–µ */
        .chat-actions { 
            display: flex; 
            gap: 8px; 
            margin-left: 8px;
        }
        .action-button { 
            background: var(--background); 
            border: 1px solid var(--border); 
            border-radius: 12px; 
            padding: 8px 12px; 
            font-size: 12px; 
            cursor: pointer; 
            color: var(--text);
            transition: all 0.2s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Ç–æ–º */
        .chat-controls {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        .control-button {
            flex: 1;
            min-width: 120px;
            padding: 10px 16px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        .control-button.add-friend {
            background: var(--success);
            color: white;
        }
        .control-button.like {
            background: var(--accent);
            color: white;
        }
        .control-button.dislike {
            background: var(--error);
            color: white;
        }
        .control-button:active {
            transform: scale(0.95);
        }
        
        .messages-container { 
            flex: 1; 
            overflow-y: auto; 
            padding: 16px; 
            margin-bottom: 120px; 
            max-height: calc(100vh - 250px);
            background: var(--chat-bg);
        }
        .message { 
            margin-bottom: 12px; 
            padding: 12px 16px; 
            border-radius: var(--bubble-radius); 
            max-width: 80%; 
            word-wrap: break-word; 
            position: relative; 
            transition: transform 0.2s ease, opacity 0.3s ease;
            font-size: var(--font-size);
        }
        .message-my { 
            background: var(--message-bg-my); 
            color: var(--message-text-my); 
            margin-left: auto; 
            border-bottom-right-radius: 4px; 
        }
        .message-their { 
            background: var(--message-bg-their); 
            color: var(--message-text-their); 
            margin-right: auto; 
            border-bottom-left-radius: 4px; 
            border: 1px solid var(--border); 
        }
        .message-time { font-size: 11px; opacity: 0.7; margin-top: 4px; text-align: right; }
        .message-sender { font-size: 12px; font-weight: 600; margin-bottom: 4px; }
        
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .message-input-container {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--surface);
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 25px;
            display: flex;
            gap: 12px;
            width: 380px;
            max-width: calc(100% - 40px);
            justify-content: space-between;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            z-index: 1001;
        }

        #messageInput {
            flex: 1;
            padding: 12px 16px;
            border: none;
            border-radius: 20px;
            font-size: var(--font-size);
            background: var(--background);
            color: var(--text);
            outline: none;
        }

        .send-button {
            background: var(--primary);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .send-button:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        .snackbar { 
            position: fixed; 
            bottom: 100px; 
            left: 50%; 
            transform: translateX(-50%); 
            background: var(--text); 
            color: white; 
            padding: 12px 20px; 
            border-radius: 12px; 
            font-size: 14px; 
            z-index: 3000; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.15); 
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 420px) { 
            .bottom-menu { width: 100%; max-width: 100%; border-radius: 0; }
            .message-input-container { width: calc(100% - 40px); }
            .control-button { min-width: 100px; }
        }
        
        @media (max-width: 380px) { 
            .container { padding-left: 12px; padding-right: 12px; }
            .message-input-container { width: calc(100% - 32px); }
            .control-button { min-width: 90px; font-size: 12px; }
        }
    </style>
</head>
<body>
    <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω - –ß–∞—Ç—ã -->
    <div class="screen active" id="chatsScreen">
        <div class="container">
            <div class="header">
                <h1>–ê–Ω–æ–Ω–∏–º–Ω—ã–π —á–∞—Ç</h1>
                <p>–û–±—â–∞–π—Ç–µ—Å—å –∞–Ω–æ–Ω–∏–º–Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
            </div>
            
            <!-- –í–ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 3 -->
            <div id="vkUserInfo" class="vk-user-info" style="display: none;">
                <div class="vk-avatar" id="vkAvatar">VK</div>
                <div>
                    <div style="font-weight: 600;" id="vkUserName"></div>
                    <div style="font-size: 14px; color: var(--text-secondary);">–í–ö–æ–Ω—Ç–∞–∫—Ç–µ</div>
                </div>
            </div>
            
            <div class="notification-section">
                <div class="notification-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</div>
                <div class="notification-text">–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∞–Ω–æ–Ω–∏–º–Ω—ã–µ —á–∞—Ç—ã –∏ –Ω–∞—Ö–æ–¥–∏—Ç–µ –Ω–æ–≤—ã—Ö –¥—Ä—É–∑–µ–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</div>
                <button class="notification-button" onclick="enableNotifications()">–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
            </div>
            
            <!-- –í–∫–ª–∞–¥–∫–∏ —á–∞—Ç–æ–≤ -->
            <div class="chat-tabs">
                <div class="chat-tab active" onclick="switchChatTab('–û–±—â–µ–Ω–∏–µ')">üí¨ –û–±—â–µ–Ω–∏–µ</div>
                <div class="chat-tab" onclick="switchChatTab('–§–ª–∏—Ä—Ç')">üòä –§–ª–∏—Ä—Ç</div>
                <div class="chat-tab" onclick="switchChatTab('–†–æ–ª—å')">üé≠ –†–æ–ª—å</div>
            </div>
            
            <div class="create-chat-card" onclick="openCreateChatModal()">
                <div class="create-chat-icon">+</div>
                <div class="create-chat-text" id="createChatText">–°–æ–∑–¥–∞—Ç—å —á–∞—Ç –¥–ª—è –û–±—â–µ–Ω–∏—è</div>
            </div>
            
            <div class="user-cards" id="chatsContainer">
                <!-- –ß–∞—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –ø—Ä–æ—Ñ–∏–ª—è -->
    <div class="screen" id="profileScreen">
        <div class="container">
            <div class="header">
                <h1>–ü—Ä–æ—Ñ–∏–ª—å</h1>
                <p>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</p>
            </div>
            
            <div class="profile-section">
                <div class="profile-header">
                    <div class="profile-avatar" id="currentAvatar">üë§</div>
                    <h2 id="profileName">–ê–Ω–æ–Ω–∏–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
                    <p>–†–µ–ø—É—Ç–∞—Ü–∏—è: <span id="profileReputation">150</span> –±–∞–ª–ª–æ–≤</p>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="chatsCount">0</div>
                        <div class="stat-label">–°–æ–∑–¥–∞–Ω–æ —á–∞—Ç–æ–≤</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="messagesCount">0</div>
                        <div class="stat-label">–°–æ–æ–±—â–µ–Ω–∏–π</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="friendsCount">0</div>
                        <div class="stat-label">–î—Ä—É–∑–µ–π</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="daysCount">1</div>
                        <div class="stat-label">–î–Ω–µ–π –≤ —á–∞—Ç–µ</div>
                    </div>
                </div>
            </div>
            
            <div class="settings-list">
                <div class="setting-item" onclick="shareApp()">
                    <div class="setting-info">
                        <div class="setting-title">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º</div>
                        <div class="setting-description">–†–∞—Å—Å–∫–∞–∑–∞—Ç—å –¥—Ä—É–∑—å—è–º –æ —á–∞—Ç–µ</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
                <div class="setting-item" onclick="openMyChats()">
                    <div class="setting-info">
                        <div class="setting-title">–ú–æ–∏ —á–∞—Ç—ã</div>
                        <div class="setting-description">–ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
                <div class="setting-item" onclick="inviteFriends()">
                    <div class="setting-info">
                        <div class="setting-title">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π</div>
                        <div class="setting-description">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–∑–µ–π –∏–∑ VK</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div class="screen" id="settingsScreen">
        <div class="container">
            <div class="header">
                <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º</p>
            </div>
            
            <div class="settings-list">
                <div class="setting-item" onclick="openThemeSettings()">
                    <div class="setting-info">
                        <div class="setting-title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</div>
                        <div class="setting-description">–¢–µ–º—ã, —à—Ä–∏—Ñ—Ç—ã, —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
                <div class="setting-item" onclick="openChatSettings()">
                    <div class="setting-info">
                        <div class="setting-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞</div>
                        <div class="setting-description">–í–Ω–µ—à–Ω–∏–π –≤–∏–¥ —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
                <div class="setting-item" onclick="openNotificationsSettings()">
                    <div class="setting-info">
                        <div class="setting-title">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                        <div class="setting-description">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
                <div class="setting-item" onclick="openPrivacySettings()">
                    <div class="setting-info">
                        <div class="setting-title">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</div>
                        <div class="setting-description">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
                <div class="setting-item" onclick="addToFavorites()">
                    <div class="setting-info">
                        <div class="setting-title">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
                        <div class="setting-description">–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
                <div class="setting-item" onclick="openAppInfo()">
                    <div class="setting-info">
                        <div class="setting-title">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</div>
                        <div class="setting-description">–í–µ—Ä—Å–∏—è –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
                <div class="setting-item" onclick="support()">
                    <div class="setting-info">
                        <div class="setting-title">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                        <div class="setting-description">–°–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏</div>
                    </div>
                    <div class="setting-arrow">‚Ä∫</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω —á–∞—Ç–∞ -->
    <div class="screen" id="chatRoomScreen">
        <div class="container">
            <div class="screen-header">
                <button class="back-button" onclick="leaveChat()">‚Äπ</button>
                <div class="chat-info">
                    <div class="chat-title" id="chatRoomTitle">–ß–∞—Ç</div>
                    <div class="chat-members">
                        <span id="onlineCount">1 —É—á–∞—Å—Ç–Ω–∏–∫</span>
                        <span id="typingIndicator" style="display: none;"> - –ø–µ—á–∞—Ç–∞–µ—Ç...</span>
                    </div>
                </div>
                
                <!-- –®–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–∞—Ç–∞ -->
                <div class="chat-settings">
                    <button class="settings-button" onclick="toggleChatSettings()">‚öôÔ∏è</button>
                    <div class="settings-dropdown" id="chatSettingsDropdown">
                        <div class="settings-item" onclick="openThemeSettings()">
                            <span>üé®</span> –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ
                        </div>
                        <div class="settings-item" onclick="clearChatHistory()">
                            <span>üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
                        </div>
                        <div class="settings-item" onclick="reportChat()">
                            <span>‚ö†Ô∏è</span> –ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è
                        </div>
                    </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–ª–∞ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞ -->
                <div class="chat-actions">
                    <button class="action-button" onclick="showPartnerGender()">
                        <span>üë§</span>–ü–æ–ª —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞
                    </button>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–∫ –Ω–∞ —Ñ–æ—Ç–æ -->
            <div class="chat-controls">
                <button class="control-button add-friend" onclick="sendFriendRequest()">
                    <span>üë§</span>–î–æ–±–∞–≤–∏—Ç—å –≤ –¥—Ä—É–∑—å—è
                </button>
                <button class="control-button like" onclick="sendLike()">
                    <span>‚ù§Ô∏è</span>–ù—Ä–∞–≤–∏—Ç—Å—è —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫
                </button>
                <button class="control-button dislike" onclick="sendDislike()">
                    <span>üëé</span>–ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è
                </button>
            </div>

            <div class="messages-container" id="messagesContainer">
                <!-- –°–æ–æ–±—â–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>

            <div class="message-input-container">
                <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="500" onkeypress="handleKeyPress(event)">
                <button class="send-button" onclick="sendMessage()">
                    <span style="font-size: 18px;">‚û§</span>
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞ -->
    <div class="modal-overlay" id="createChatModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">–°–æ–∑–¥–∞—Ç—å —á–∞—Ç –¥–ª—è –û–±—â–µ–Ω–∏—è</div>
                <button class="close-button" onclick="closeCreateChatModal()">√ó</button>
            </div>
            
            <div class="form-group">
                <label class="form-label">–í–∞—à –ø–æ–ª</label>
                <div class="options-grid" id="myGenderOptions">
                    <div class="option-button active" onclick="toggleOption(this)">–ú—É–∂—Å–∫–æ–π</div>
                    <div class="option-button" onclick="toggleOption(this)">–ñ–µ–Ω—Å–∫–∏–π</div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">–í–∞—à –≤–æ–∑—Ä–∞—Å—Ç</label>
                <input type="number" class="age-input" id="myAge" placeholder="25" min="18" max="80" value="25">
            </div>
            
            <div class="form-group">
                <label class="form-label">–ü–æ–ª —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞</label>
                <div class="options-grid" id="partnerGenderOptions">
                    <div class="option-button" onclick="toggleOption(this)">–ú—É–∂—Å–∫–æ–π</div>
                    <div class="option-button" onclick="toggleOption(this)">–ñ–µ–Ω—Å–∫–∏–π</div>
                    <div class="option-button active" onclick="toggleOption(this)">–õ—é–±–æ–π</div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">–í–æ–∑—Ä–∞—Å—Ç —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞</label>
                <div class="slider-container">
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>–î–∏–∞–ø–∞–∑–æ–Ω: <span id="minAgeValue">18</span> - <span id="maxAgeValue">35</span> –ª–µ—Ç</span>
                        </div>
                        <div class="slider-wrapper">
                            <input type="range" min="18" max="80" value="18" class="slider" id="minAgeSlider" oninput="updateAgeRange()">
                            <input type="range" min="18" max="80" value="35" class="slider" id="maxAgeSlider" oninput="updateAgeRange()">
                        </div>
                    </div>
                </div>
                <input type="hidden" id="minAge" value="18">
                <input type="hidden" id="maxAge" value="35">
            </div>
            
            <button class="create-button" onclick="createChat()">–°–æ–∑–¥–∞—Ç—å —á–∞—Ç</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∑–∞–ø—Ä–æ—Å–∞ –¥—Ä—É–∂–±—ã -->
    <div class="modal-overlay" id="friendRequestModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–ó–∞–ø—Ä–æ—Å –¥—Ä—É–∂–±—ã</div>
                <button class="close-button" onclick="closeFriendRequestModal()">√ó</button>
            </div>
            
            <div style="text-align: center; padding: 20px 0;">
                <div style="font-size: 48px; margin-bottom: 16px;">üë§</div>
                <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">–í–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –¥—Ä—É–∂–±—É!</div>
                <div style="color: var(--text-secondary); margin-bottom: 24px;">–•–æ—Ç–∏—Ç–µ –ø—Ä–∏–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥—Ä—É–∂–±—É?</div>
                
                <div style="display: flex; gap: 12px;">
                    <button class="control-button add-friend" style="flex: 1;" onclick="acceptFriendRequest()">
                        <span>‚úì</span>–ü—Ä–∏–Ω—è—Ç—å
                    </button>
                    <button class="control-button dislike" style="flex: 1;" onclick="declineFriendRequest()">
                        <span>‚úï</span>–û—Ç–∫–ª–æ–Ω–∏—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è -->
    <div class="modal-overlay" id="themeSettingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</div>
                <button class="close-button" onclick="closeThemeSettings()">√ó</button>
            </div>
            
            <div class="theme-options">
                <div class="theme-option active" onclick="setTheme('light')">
                    <div class="theme-preview theme-light"></div>
                    <div>
                        <div class="setting-title">–°–≤–µ—Ç–ª–∞—è</div>
                        <div class="setting-description">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞</div>
                    </div>
                </div>
                <div class="theme-option" onclick="setTheme('dark')">
                    <div class="theme-preview theme-dark"></div>
                    <div>
                        <div class="setting-title">–¢–µ–º–Ω–∞—è</div>
                        <div class="setting-description">–ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è –¥–ª—è –≥–ª–∞–∑</div>
                    </div>
                </div>
                <div class="theme-option" onclick="setTheme('blue')">
                    <div class="theme-preview theme-blue"></div>
                    <div>
                        <div class="setting-title">–°–∏–Ω—è—è</div>
                        <div class="setting-description">–°–≤–µ–∂–∞—è —Å–∏–Ω—è—è —Ç–µ–º–∞</div>
                    </div>
                </div>
                <div class="theme-option" onclick="setTheme('green')">
                    <div class="theme-preview theme-green"></div>
                    <div>
                        <div class="setting-title">–ó–µ–ª–µ–Ω–∞—è</div>
                        <div class="setting-description">–°–ø–æ–∫–æ–π–Ω–∞—è –∑–µ–ª–µ–Ω–∞—è —Ç–µ–º–∞</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–∞—Ç–∞ -->
    <div class="modal-overlay" id="chatSettingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞</div>
                <button class="close-button" onclick="closeChatSettings()">√ó</button>
            </div>
            
            <div class="chat-settings-options">
                <div class="setting-card">
                    <div class="setting-card-title">–†–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞</div>
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞</span>
                            <span class="slider-value" id="fontSizeValue">16px</span>
                        </div>
                        <input type="range" min="12" max="20" value="16" class="slider" id="fontSizeSlider" oninput="updateFontSize(this.value)">
                    </div>
                </div>
                
                <div class="setting-card">
                    <div class="setting-card-title">–°–∫—Ä—É–≥–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>–†–∞–¥–∏—É—Å —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è</span>
                            <span class="slider-value" id="bubbleRadiusValue">18px</span>
                        </div>
                        <input type="range" min="8" max="25" value="18" class="slider" id="bubbleRadiusSlider" oninput="updateBubbleRadius(this.value)">
                    </div>
                </div>
                
                <div class="setting-card">
                    <div class="setting-card-title">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</div>
                    <div class="message-preview">
                        <div class="preview-message their">–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?</div>
                        <div class="preview-message my">–û—Ç–ª–∏—á–Ω–æ! –ê —É —Ç–µ–±—è?</div>
                    </div>
                </div>
                
                <button class="create-button" onclick="resetChatSettings()">–°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é -->
    <div class="bottom-menu">
        <div class="menu-item active" onclick="showScreen('chatsScreen')">
            <div class="menu-icon">üí¨</div>
            <div class="menu-text">–ß–∞—Ç—ã</div>
        </div>
        <div class="menu-item" onclick="showScreen('profileScreen')">
            <div class="menu-icon">üë§</div>
            <div class="menu-text">–ü—Ä–æ—Ñ–∏–ª—å</div>
        </div>
        <div class="menu-item" onclick="showScreen('settingsScreen')">
            <div class="menu-icon">‚öôÔ∏è</div>
            <div class="menu-text">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const CONFIG = {
            API_URL: 'https://anonymous-chat-vk.onrender.com',
            SOCKET_URL: 'https://anonymous-chat-vk.onrender.com',
            MAX_MESSAGE_LENGTH: 500,
            MAX_AGE: 80,
            MIN_AGE: 18,
            CACHE_TTL: 300000,
            TYPING_TIMEOUT: 1000
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let allChats = [];
        let userStats = {
            createdChats: 0,
            sentMessages: 0,
            friends: 0,
            daysActive: 1,
            reputation: 150
        };
        let vkUser = null;
        let currentChat = null;
        let socket = null;
        let isVK = false;
        let currentTheme = '–û–±—â–µ–Ω–∏–µ';
        let typingTimer = null;
        let onlineUsers = new Set();
        let pendingFriendRequest = null;
        let chatParticipants = {};
        let currentAppTheme = 'light';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        async function initApp() {
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
                loadThemeSettings();
                loadChatSettings();
                
                if (typeof vkBridge !== 'undefined') {
                    await vkBridge.send('VKWebAppInit');
                    isVK = true;
                    const userInfo = await vkBridge.send('VKWebAppGetUserInfo');
                    vkUser = userInfo;
                    updateUserInterface(userInfo);
                    showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ' + userInfo.first_name + '!');
                } else {
                    throw new Error('VK Bridge not available');
                }
            } catch (error) {
                console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤–Ω–µ VK:', error.message);
                isVK = false;
                vkUser = { 
                    id: 'test_user_' + Date.now(), 
                    first_name: '–¢–µ—Å—Ç', 
                    last_name: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å' 
                };
                updateUserInterface(vkUser);
                showNotification('–†–µ–∂–∏–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —á–∞—Ç—ã');
            }

            initSocket();
            await loadAndRenderChats();
            loadUserStats();
            updateProfileStats();
            setupEventListeners();
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞–º–∏
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            if (screenId === 'chatsScreen') {
                document.querySelector('.menu-item:nth-child(1)').classList.add('active');
            } else if (screenId === 'profileScreen') {
                document.querySelector('.menu-item:nth-child(2)').classList.add('active');
            } else if (screenId === 'settingsScreen') {
                document.querySelector('.menu-item:nth-child(3)').classList.add('active');
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –≤ —á–∞—Ç–µ
            if (screenId === 'chatRoomScreen') {
                document.body.classList.add('chat-room-active');
            } else {
                document.body.classList.remove('chat-room-active');
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏
        function loadThemeSettings() {
            const savedTheme = localStorage.getItem('app_theme') || 'light';
            setTheme(savedTheme);
        }

        function setTheme(theme) {
            currentAppTheme = theme;
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('app_theme', theme);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –æ–ø—Ü–∏—é –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
            });
            
            const themeElement = document.querySelector(`.theme-option:nth-child(${
                theme === 'light' ? 1 : 
                theme === 'dark' ? 2 : 
                theme === 'blue' ? 3 : 4
            })`);
            if (themeElement) {
                themeElement.classList.add('active');
            }
            
            closeThemeSettings();
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞
        function loadChatSettings() {
            const fontSize = localStorage.getItem('chat_font_size') || '16';
            const bubbleRadius = localStorage.getItem('chat_bubble_radius') || '18';
            
            updateFontSize(fontSize, false);
            updateBubbleRadius(bubbleRadius, false);
        }

        function updateFontSize(size, save = true) {
            document.documentElement.style.setProperty('--font-size', size + 'px');
            document.getElementById('fontSizeValue').textContent = size + 'px';
            document.getElementById('fontSizeSlider').value = size;
            
            if (save) {
                localStorage.setItem('chat_font_size', size);
            }
        }

        function updateBubbleRadius(radius, save = true) {
            document.documentElement.style.setProperty('--bubble-radius', radius + 'px');
            document.getElementById('bubbleRadiusValue').textContent = radius + 'px';
            document.getElementById('bubbleRadiusSlider').value = radius;
            
            if (save) {
                localStorage.setItem('chat_bubble_radius', radius);
            }
        }

        function resetChatSettings() {
            updateFontSize('16');
            updateBubbleRadius('18');
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã');
        }

        // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        function openThemeSettings() {
            document.getElementById('themeSettingsModal').style.display = 'flex';
        }

        function closeThemeSettings() {
            document.getElementById('themeSettingsModal').style.display = 'none';
        }

        function openChatSettings() {
            document.getElementById('chatSettingsModal').style.display = 'flex';
        }

        function closeChatSettings() {
            document.getElementById('chatSettingsModal').style.display = 'none';
        }

        // –®–µ—Å—Ç–µ—Ä–µ–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–∞—Ç–∞
        function toggleChatSettings() {
            const dropdown = document.getElementById('chatSettingsDropdown');
            dropdown.classList.toggle('active');
            
            setTimeout(() => {
                document.addEventListener('click', closeChatSettingsDropdown);
            }, 100);
        }

        function closeChatSettingsDropdown(event) {
            const dropdown = document.getElementById('chatSettingsDropdown');
            if (!event.target.closest('.chat-settings')) {
                dropdown.classList.remove('active');
                document.removeEventListener('click', closeChatSettingsDropdown);
            }
        }

        function clearChatHistory() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞?')) {
                const container = document.getElementById('messagesContainer');
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üí≠</div>
                        <div>–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ –æ—á–∏—â–µ–Ω–∞</div>
                    </div>
                `;
                showNotification('–ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ –æ—á–∏—â–µ–Ω–∞');
                document.getElementById('chatSettingsDropdown').classList.remove('active');
            }
        }

        function reportChat() {
            showNotification('–ñ–∞–ª–æ–±–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º');
            document.getElementById('chatSettingsDropdown').classList.remove('active');
        }

        // –í–∫–ª–∞–¥–∫–∏ —á–∞—Ç–æ–≤
        function switchChatTab(theme) {
            currentTheme = theme;
            document.querySelectorAll('.chat-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('createChatText').textContent = '–°–æ–∑–¥–∞—Ç—å —á–∞—Ç –¥–ª—è ' + theme;
            document.getElementById('modalTitle').textContent = '–°–æ–∑–¥–∞—Ç—å —á–∞—Ç –¥–ª—è ' + theme;
            renderChatsList();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞
        function openCreateChatModal() {
            document.getElementById('createChatModal').style.display = 'flex';
        }

        function closeCreateChatModal() {
            document.getElementById('createChatModal').style.display = 'none';
        }

        function toggleOption(element) {
            const parent = element.parentElement;
            parent.querySelectorAll('.option-button').forEach(btn => {
                btn.classList.remove('active');
            });
            element.classList.add('active');
        }

        function updateAgeRange() {
            const minSlider = document.getElementById('minAgeSlider');
            const maxSlider = document.getElementById('maxAgeSlider');
            const minAgeValue = document.getElementById('minAgeValue');
            const maxAgeValue = document.getElementById('maxAgeValue');
            const minAge = document.getElementById('minAge');
            const maxAge = document.getElementById('maxAge');
            
            let minVal = parseInt(minSlider.value);
            let maxVal = parseInt(maxSlider.value);
            
            if (minVal > maxVal) {
                minVal = maxVal;
                minSlider.value = minVal;
            }
            
            minAgeValue.textContent = minVal;
            maxAgeValue.textContent = maxVal;
            minAge.value = minVal;
            maxAge.value = maxVal;
        }

        function createChat() {
            const myGender = document.querySelector('#myGenderOptions .option-button.active').textContent;
            const myAge = document.getElementById('myAge').value || 25;
            const partnerGender = document.querySelector('#partnerGenderOptions .option-button.active').textContent;
            const minAge = document.getElementById('minAge').value;
            const maxAge = document.getElementById('maxAge').value;
            
            if (!myAge || myAge < 18 || myAge > 80) {
                showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç (18-80)');
                return;
            }
            
            const newChat = {
                id: 'chat_' + Date.now(),
                theme: currentTheme,
                myGender,
                myAge: parseInt(myAge),
                partnerGender,
                minAge: parseInt(minAge),
                maxAge: parseInt(maxAge),
                createdAt: new Date(),
                participants: 1,
                messages: []
            };
            
            allChats.unshift(newChat);
            userStats.createdChats++;
            updateProfileStats();
            
            closeCreateChatModal();
            renderChatsList();
            showNotification('–ß–∞—Ç —Å–æ–∑–¥–∞–Ω! –ò—â–µ–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞...');
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ —á–∞—Ç
            joinChat(newChat);
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–ø–∏—Å–∫–∞ —á–∞—Ç–æ–≤
        function renderChatsList() {
            const container = document.getElementById('chatsContainer');
            const filteredChats = allChats.filter(chat => chat.theme === currentTheme);
            
            if (filteredChats.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üí¨</div>
                        <div>–ü–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤</div>
                        <div style="font-size: 14px; margin-top: 8px;">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —á–∞—Ç –¥–ª—è ${currentTheme}</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredChats.map(chat => `
                <div class="user-card" onclick="joinChat('${chat.id}')">
                    <div class="user-info">
                        <div class="info-row">
                            <span class="info-label">–¢–µ–º–∞:</span>
                            <span class="info-value">${chat.theme}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</span>
                            <span class="info-value">${chat.participants}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–í–∞—à –ø–æ–ª:</span>
                            <span class="info-value">${chat.myGender}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–í–∞—à –≤–æ–∑—Ä–∞—Å—Ç:</span>
                            <span class="info-value">${chat.myAge}</span>
                        </div>
                    </div>
                    <div class="theme-tag">${chat.theme}</div>
                </div>
            `).join('');
        }

        // –í—Ö–æ–¥ –≤ —á–∞—Ç
        function joinChat(chatId) {
            const chat = typeof chatId === 'string' ? allChats.find(c => c.id === chatId) : chatId;
            if (!chat) return;
            
            currentChat = chat;
            document.getElementById('chatRoomTitle').textContent = `–ß–∞—Ç –¥–ª—è ${chat.theme}`;
            document.getElementById('onlineCount').textContent = `${chat.participants} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤`;
            
            // –†–µ–Ω–¥–µ—Ä–∏–º —Å–æ–æ–±—â–µ–Ω–∏—è
            const container = document.getElementById('messagesContainer');
            if (chat.messages.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 16px;">üí≠</div>
                        <div>–ß–∞—Ç —Å–æ–∑–¥–∞–Ω! –ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–≤—ã–º</div>
                    </div>
                `;
            } else {
                container.innerHTML = chat.messages.map(msg => `
                    <div class="message ${msg.isMy ? 'message-my' : 'message-their'}">
                        ${!msg.isMy ? `<div class="message-sender">–°–æ–±–µ—Å–µ–¥–Ω–∏–∫</div>` : ''}
                        <div>${msg.text}</div>
                        <div class="message-time">${msg.time}</div>
                    </div>
                `).join('');
                container.scrollTop = container.scrollHeight;
            }
            
            showScreen('chatRoomScreen');
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();
            
            if (!text || !currentChat) return;
            
            if (text.length > CONFIG.MAX_MESSAGE_LENGTH) {
                showNotification(`–°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ (–º–∞–∫—Å–∏–º—É–º ${CONFIG.MAX_MESSAGE_LENGTH} —Å–∏–º–≤–æ–ª–æ–≤)`);
                return;
            }
            
            const message = {
                id: 'msg_' + Date.now(),
                text: text,
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                isMy: true
            };
            
            currentChat.messages.push(message);
            userStats.sentMessages++;
            updateProfileStats();
            
            // –†–µ–Ω–¥–µ—Ä–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            const container = document.getElementById('messagesContainer');
            if (container.querySelector('.message') === null) {
                container.innerHTML = '';
            }
            
            const messageElement = document.createElement('div');
            messageElement.className = 'message message-my';
            messageElement.innerHTML = `
                <div>${message.text}</div>
                <div class="message-time">${message.time}</div>
            `;
            
            container.appendChild(messageElement);
            container.scrollTop = container.scrollHeight;
            
            input.value = '';
            
            // –°–∏–º—É–ª—è—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
            simulateResponse();
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function simulateResponse() {
            setTimeout(() => {
                if (!currentChat) return;
                
                const responses = [
                    "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?",
                    "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –æ—Ç–∫—É–¥–∞ —Ç—ã?",
                    "–Ø —Ç–æ–∂–µ –ª—é–±–ª—é –æ–±—â–∞—Ç—å—Å—è –Ω–∞ —ç—Ç—É —Ç–µ–º—É!",
                    "–†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ —á—Ç–æ-–Ω–∏–±—É–¥—å",
                    "–ö–∞–∫ –ø—Ä–æ—à–µ–ª —Ç–≤–æ–π –¥–µ–Ω—å?",
                    "–ú—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –æ–¥–Ω–æ–º –≥–æ—Ä–æ–¥–µ?",
                    "–ß—Ç–æ –¥—É–º–∞–µ—à—å –æ–± —ç—Ç–æ–π —Ç–µ–º–µ?",
                    "–£ —Ç–µ–±—è –µ—Å—Ç—å —Ö–æ–±–±–∏?"
                ];
                
                const response = {
                    id: 'msg_' + Date.now(),
                    text: responses[Math.floor(Math.random() * responses.length)],
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    isMy: false
                };
                
                currentChat.messages.push(response);
                
                const container = document.getElementById('messagesContainer');
                const messageElement = document.createElement('div');
                messageElement.className = 'message message-their';
                messageElement.innerHTML = `
                    <div class="message-sender">–°–æ–±–µ—Å–µ–¥–Ω–∏–∫</div>
                    <div>${response.text}</div>
                    <div class="message-time">${response.time}</div>
                `;
                
                container.appendChild(messageElement);
                container.scrollTop = container.scrollHeight;
            }, 2000 + Math.random() * 3000);
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–æ–º
        function leaveChat() {
            currentChat = null;
            showScreen('chatsScreen');
        }

        function sendFriendRequest() {
            showNotification('–ó–∞–ø—Ä–æ—Å –¥—Ä—É–∂–±—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω');
        }

        function sendLike() {
            showNotification('‚ù§Ô∏è –í—ã –≤—ã—Ä–∞–∑–∏–ª–∏ —Å–∏–º–ø–∞—Ç–∏—é —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫—É');
        }

        function sendDislike() {
            if (confirm('–ü–æ–∫–∏–Ω—É—Ç—å —ç—Ç–æ—Ç —á–∞—Ç?')) {
                showNotification('–ß–∞—Ç –∑–∞–≤–µ—Ä—à–µ–Ω');
                leaveChat();
            }
        }

        function showPartnerGender() {
            const genders = ['–ú—É–∂—Å–∫–æ–π', '–ñ–µ–Ω—Å–∫–∏–π'];
            const gender = genders[Math.floor(Math.random() * genders.length)];
            showNotification(`–ü–æ–ª —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞: ${gender}`);
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message) {
            const snackbar = document.createElement('div');
            snackbar.className = 'snackbar';
            snackbar.textContent = message;
            document.body.appendChild(snackbar);
            
            setTimeout(() => {
                snackbar.remove();
            }, 3000);
        }

        function enableNotifications() {
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        showNotification('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã');
                    }
                });
            } else {
                showNotification('–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è');
            }
        }

        // –ü—Ä–æ—Ñ–∏–ª—å –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        function updateUserInterface(userInfo) {
            document.getElementById('vkUserName').textContent = userInfo.first_name + ' ' + userInfo.last_name;
            document.getElementById('vkUserInfo').style.display = 'flex';
            document.getElementById('profileName').textContent = userInfo.first_name + ' ' + userInfo.last_name;
            document.getElementById('currentAvatar').textContent = userInfo.first_name.charAt(0);
        }

        function loadUserStats() {
            const savedStats = localStorage.getItem('userStats');
            if (savedStats) {
                userStats = JSON.parse(savedStats);
            }
        }

        function updateProfileStats() {
            document.getElementById('chatsCount').textContent = userStats.createdChats;
            document.getElementById('messagesCount').textContent = userStats.sentMessages;
            document.getElementById('friendsCount').textContent = userStats.friends;
            document.getElementById('daysCount').textContent = userStats.daysActive;
            document.getElementById('profileReputation').textContent = userStats.reputation;
            
            localStorage.setItem('userStats', JSON.stringify(userStats));
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function shareApp() {
            showNotification('–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');
        }

        function openMyChats() {
            showScreen('chatsScreen');
        }

        function inviteFriends() {
            showNotification('–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–∑—å—è–º –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ');
        }

        function openNotificationsSettings() {
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç–∫—Ä—ã—Ç—ã');
        }

        function openPrivacySettings() {
            showNotification('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä—ã—Ç—ã');
        }

        function addToFavorites() {
            showNotification('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ');
        }

        function openAppInfo() {
            showNotification('–í–µ—Ä—Å–∏—è 1.0.0\n–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: –ê–Ω–æ–Ω–∏–º–Ω—ã–π –ß–∞—Ç');
        }

        function support() {
            showNotification('–°–≤—è–∑—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π: support@anonymouschat.ru');
        }

        // –°–æ–∫–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (–∑–∞–≥–ª—É—à–∫–∞)
        function initSocket() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Å–æ–∫–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
            console.log('Socket connection initialized');
        }

        function loadAndRenderChats() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞—Ç–æ–≤
            return Promise.resolve();
        }

        function setupEventListeners() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–∑—É–Ω–∫–æ–≤ –≤–æ–∑—Ä–∞—Å—Ç–∞
            updateAgeRange();
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
